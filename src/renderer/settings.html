<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nastaven√≠ - Void-Craft Launcher</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .settings-container {
            padding: 20px;
            color: white;
            height: calc(100vh - 32px);
            overflow-y: auto;
        }
        .setting-group {
            background: #1f1f3a;
            border: 1px solid #7c3aed;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .setting-group h3 {
            color: #a78bfa;
            margin-bottom: 15px;
        }
        .setting-item {
            margin-bottom: 12px;
        }
        .setting-item label {
            display: block;
            margin-bottom: 5px;
            color: #9ca3af;
        }
        .setting-item input,
        .setting-item select {
            width: 100%;
            padding: 8px;
            background: #0f0f1e;
            border: 1px solid #7c3aed;
            border-radius: 6px;
            color: white;
            font-size: 14px;
        }
        .btn-save {
            width: 100%;
            padding: 10px;
            background: linear-gradient(135deg, #7c3aed, #a78bfa);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            margin-top: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }
        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(124, 58, 237, 0.6);
        }
    </style>
</head>
<body style="background: #0a0a0a;">
    <div class="titlebar">
        <div class="titlebar-drag">
            <span class="titlebar-title">‚öôÔ∏è Void-Craft Launcher - Nastaven√≠</span>
        </div>
        <div class="titlebar-buttons">
            <button class="titlebar-button minimize" id="minimizeBtn">‚îÄ</button>
            <button class="titlebar-button maximize" id="maximizeBtn">‚ñ°</button>
            <button class="titlebar-button close" id="closeBtn">‚úï</button>
        </div>
    </div>
    <div class="settings-container">
        <h1 style="color: #a78bfa; margin-bottom: 20px; font-size: 24px;">‚öôÔ∏è Nastaven√≠</h1>

        <div class="setting-group">
            <h3 style="font-size: 16px;">üéÆ Hern√≠ nastaven√≠</h3>
            <div class="setting-item">
                <label>Alokovan√° RAM (GB)</label>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <input type="range" id="ramSlider" min="2" max="16" step="0.5" value="4" style="flex:2;">
                    <input type="number" id="ramInput" min="2" max="16" step="0.5" value="4" style="width:60px;flex:1;">
                    <span id="ramMaxInfo" style="margin-left:8px;font-size:12px;color:#a78bfa;"></span>
                </div>
            </div>
            <div class="setting-item">
                <label>Rozli≈°en√≠ okna</label>
                <select id="resolution">
                    <option value="854x480">854x480</option>
                    <option value="1280x720">1280x720</option>
                    <option value="1920x1080" selected>1920x1080</option>
                    <option value="2560x1440">2560x1440</option>
                </select>
            </div>
        </div>

        <div class="setting-group">
            <h3 style="font-size: 16px;">‚òï Java nastaven√≠</h3>
            <div class="setting-item">
                <label>Cesta k Java (nechej pr√°zdn√© pro automatickou detekci)</label>
                <input type="text" id="javaPath" placeholder="C:\Program Files\Java\...">
            </div>
        </div>

        <div class="setting-group">
            <h3 style="font-size: 16px;">üìÅ Slo≈æky</h3>
            <div class="setting-item">
                <label>Minecraft slo≈æka</label>
                <input type="text" id="minecraftDir" readonly>
            </div>
            <div class="setting-item">
                <label>Logy</label>
                <input type="text" id="logsDir" readonly>
            </div>
        </div>

        <button class="btn-save" onclick="saveSettings()">üíæ Ulo≈æit nastaven√≠</button>
        <button class="btn-save" style="background: #4a4a6a; margin-top: 8px;" onclick="window.close()">‚ùå Zav≈ô√≠t</button>
    </div>

    <script>
        const path = require('path');
        const os = require('os');
        const fs = require('fs');

        const configPath = path.join(os.homedir(), '.void-craft-launcher', 'settings.json');
        const minecraftDir = path.join(os.homedir(), '.void-craft-launcher', 'minecraft');
        const logsDir = path.join(os.homedir(), '.void-craft-launcher', 'logs');

        // Naƒç√≠st nastaven√≠
        function loadSettings() {
            document.getElementById('minecraftDir').value = minecraftDir;
            document.getElementById('logsDir').value = logsDir;

            // Detekce maxim√°ln√≠ RAM
            const totalGB = Math.floor(os.totalmem() / (1024 * 1024 * 1024));
            const ramSlider = document.getElementById('ramSlider');
            const ramInput = document.getElementById('ramInput');
            const ramMaxInfo = document.getElementById('ramMaxInfo');
            ramSlider.max = Math.max(2, totalGB);
            ramInput.max = Math.max(2, totalGB);
            ramMaxInfo.textContent = `(Max: ${totalGB} GB)`;

            let ramValue = 12;
            if (fs.existsSync(configPath)) {
                const settings = JSON.parse(fs.readFileSync(configPath, 'utf8'));
                if (settings.ramAllocation) ramValue = Number(settings.ramAllocation);
                if (settings.resolution) document.getElementById('resolution').value = settings.resolution;
                if (settings.javaPath) document.getElementById('javaPath').value = settings.javaPath;
            }
            if (ramValue > ramSlider.max) ramValue = ramSlider.max;
            ramSlider.value = ramValue;
            ramInput.value = ramValue;
        }

        // Ulo≈æit nastaven√≠
        function saveSettings() {
            const ramValue = document.getElementById('ramInput').value;
            const settings = {
                ramAllocation: ramValue,
                resolution: document.getElementById('resolution').value,
                javaPath: document.getElementById('javaPath').value
            };

            const configDir = path.dirname(configPath);
            if (!fs.existsSync(configDir)) {
                fs.mkdirSync(configDir, { recursive: true });
            }

            fs.writeFileSync(configPath, JSON.stringify(settings, null, 2));
            alert('Nastaven√≠ ulo≈æeno!');
        }

        // Synchronizace slideru a inputu
        document.addEventListener('DOMContentLoaded', () => {
            loadSettings();
            const ramSlider = document.getElementById('ramSlider');
            const ramInput = document.getElementById('ramInput');
            ramSlider.addEventListener('input', () => {
                ramInput.value = ramSlider.value;
            });
            ramInput.addEventListener('input', () => {
                let v = Number(ramInput.value);
                if (isNaN(v) || v < Number(ramInput.min)) v = Number(ramInput.min);
                if (v > Number(ramInput.max)) v = Number(ramInput.max);
                ramInput.value = v;
                ramSlider.value = v;
            });
        });
        
        // Titlebar buttons
        const { getCurrentWindow } = require('@electron/remote');
        const win = getCurrentWindow();
        
        window.addEventListener('load', () => {
            document.getElementById('minimizeBtn').addEventListener('click', () => {
                win.minimize();
            });
            
            document.getElementById('maximizeBtn').addEventListener('click', () => {
                if (win.isMaximized()) {
                    win.unmaximize();
                } else {
                    win.maximize();
                }
            });
            
            document.getElementById('closeBtn').addEventListener('click', () => {
                win.close();
            });
        });
    </script>
</body>
</html>
